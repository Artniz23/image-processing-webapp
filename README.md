# Веб-приложение для обработки изображений

## Описание проекта

Проект представляет собой веб-приложение для обработки изображений с использованием фильтров.

### Используемые технологии

- **Фронтенд:** Angular (Single Page Application)
- **Бэкенд:** Python + FastAPI
- **База данных:** MongoDB
- **Библиотека для обработки изображений:** Pillow

Проект состоит из двух частей:

1. **image-filter-app** - Angular приложение
2. **image-filter-api** - API на Python

## Фронтенд приложение

**Основной функционал:**

- Пользователь может загрузить изображение через поле выбора файла или перетаскиванием.
- Отображается оригинальное изображение и выбор доступных фильтров.
- После применения фильтра показывается обработанное изображение рядом с оригиналом.
- Доступны кнопки для сохранения изображения в базу данных или скачивания на устройство.
- При сохранении отображается сообщение с ID сохраненного объекта.

**Структура приложения:**

- **Компоненты:**
  - `app.component.html` - главная страница, содержащая основную динамику.
  - `upload.component.html` - компонент для загрузки изображений.
  - `image-viewer.component.html` - отображение изображений (оригинал и обработанное).
  - `filter-selector.component.html` - выбор фильтров и кнопка для обработки изображения.
- **Сервис API (**`api.service.ts`**):**
  - Методы:
    - `getFilters` - запрос списка фильтров с сервера.
    - `applyFilter` - отправка изображения и названия фильтра на сервер для обработки.
    - `saveImage` - сохранение данных в базу MongoDB.

Все запросы сопровождаются визуальным спинером для отображения процесса загрузки.

## Backend API

**Функциональность:**

- Реализован с использованием FastAPI.
- Логика разделена на контроллеры, сервисы и репозитории.

**Структура проекта:**

- **Папка ****`image-filter-api/app`****:**

  - `main.py` - точка входа в приложение, настройка CORS и роутинга.
  - `core` - папка для работы с базой данных:
    - `config.py` - параметры подключения к MongoDB.
    - `db.py` - создание клиента и получение коллекции изображений.
  - `filters` - классы для реализации фильтров, фабрика фильтров (`filter_factory.py`).
  - `controllers` - обработка запросов (`image_controller.py`).
  - `services` - обработка изображений с использованием Pillow (`image_service.py`).
  - `repositories` - логика работы с MongoDB (`image_repository.py`).
  - `models` - DTO для передачи данных:
    - `ProcessImageResponseDTO` - ответ для фронтенда.
    - `SaveImageDTO` - объект для сохранения в базу данных.

- **Папка ****`tests`****:**

  - Тестовые изображения и файлы для проверки репозиториев, сервисов и роутов.
  - Используются библиотеки: `pytest`, `mocker`, `TestClient`.

## Развертывание проектов

### База данных MongoDB

1. Скачайте MongoDB с [официального сайта](https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-windows/).
2. (Опционально) Установите MongoDB Compass для графического интерфейса.
3. Убедитесь, что база данных запущена локально по адресу `localhost:27017`. Если адрес другой, измените настройки в файле `.env` в папке `image-filter-api/app/`.

### Backend API

1. Перейдите в папку `image-filter-api`.
2. Создайте виртуальное окружение:
   ```bash
   python -m venv venv
   ```
3. Запуск виртуального окружения:
   ```bash
   venv\Scripts\activate
   ```
4. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
5. Запустите сервер:
   ```bash
   python -m app.main
   ```
6. Для запуска тестов выполните:
   ```bash
   python -m pytest
   ```
   Либо запустите тесты через PyCharm.
7. Просмотр документации Swagger UI
    ```
   http://localhost:8000/docs
   ```

### Фронтенд приложение

1. Установите LTS-версию Node.js с [официального сайта](https://nodejs.org/en). Проверьте установку:
   ```bash
   node -v
   npm -v
   ```
2. Установите Angular CLI:
   ```bash
   npm install -g @angular/cli
   ```
   Проверьте установку:
   ```bash
   ng version
   ```
3. Перейдите в папку `image-filter-app` и установите зависимости:
   ```bash
   npm install
   ```
4. Запустите приложение:
   ```bash
   ng serve
   ```
5. Приложение будет доступно по адресу [http://localhost:4200](http://localhost:4200). Если нужен другой порт, используйте команду:
   ```bash
   ng serve --port 4201
   ```
6. Фотографии для загрузки изображений в корне проекта в папке `images`

